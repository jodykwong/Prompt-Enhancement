# 交互式验证脚本使用指南

**脚本名称**: interactive_verify.py  
**功能**: 支持自定义提示词的交互式验证脚本  
**版本**: v1.0

---

## 📋 功能概览

### **核心功能**

1. ✅ **交互式输入** - 支持在运行时手动输入自定义提示词
2. ✅ **多次连续测试** - 无需重启脚本，可进行多次测试
3. ✅ **思考过程展示** - 显示 DeepSeek 模型的推理过程
4. ✅ **上下文补充验证** - 验证是否包含代码仓库结构、技术栈、文件路径、依赖关系
5. ✅ **统计信息** - 显示原始长度、增强后长度、扩展比例、处理时间
6. ✅ **输入历史记录** - 支持查看和管理输入历史

---

## 🚀 快速开始

### **启动脚本**

```bash
cd /Users/jodykwong/Documents/augment-projects/Prompt-Enhancement
source venv/bin/activate
python3 interactive_verify.py
```

### **首次运行**

脚本启动后会询问：
```
是否显示模型的思考过程？(y/n，默认 y):
```

- 输入 `y` 或直接按 Enter: 显示完整的思考过程
- 输入 `n`: 只显示增强结果，不显示思考过程

---

## 💻 使用示例

### **示例 1: 测试简短提示词**

```
【测试 #1】请输入待增强的提示词
(输入 'quit' 退出, 'help' 查看帮助, 'history' 查看历史):
> 修复bug

⏳ 正在增强提示词，请稍候...
   (DeepSeek 推理模式需要 30-40 秒)

[显示思考过程...]

📝 【原始提示词】
修复bug

✨ 【增强后提示词】
────────────────────────────────────────────────────────────────────────────────
修复bug：
1. 重现问题，查看错误日志
2. 定位代码缺陷，修复问题
3. 测试验证，确保无副作用
────────────────────────────────────────────────────────────────────────────────

📊 【统计信息】
  • 原始长度: 5 字符
  • 增强后长度: 51 字符
  • 扩展比例: 10.20x
  • 处理时间: 35.42 秒

✅ 增强成功

🔍 【上下文补充验证】
────────────────────────────────────────────────────────────────────────────────
  ❌ 代码仓库结构: 未找到
  ❌ 技术栈信息: 未找到
  ❌ 文件路径: 未找到
  ❌ 依赖关系: 未找到
────────────────────────────────────────────────────────────────────────────────

📈 上下文补充覆盖率: 0/4 类别
```

### **示例 2: 测试中等长度提示词**

```
> 添加用户注册功能

[增强过程...]

✨ 【增强后提示词】
────────────────────────────────────────────────────────────────────────────────
在 src/auth/ 目录中添加用户注册功能：
1. 创建 register.js，实现注册逻辑
2. 集成 bcrypt 库进行密码加密
3. 添加数据验证，确保用户输入合法
4. 编写单元测试，覆盖率 > 80%
────────────────────────────────────────────────────────────────────────────────

📊 【统计信息】
  • 原始长度: 8 字符
  • 增强后长度: 109 字符
  • 扩展比例: 13.62x
  • 处理时间: 38.15 秒

✅ 增强成功

🔍 【上下文补充验证】
────────────────────────────────────────────────────────────────────────────────
  ✅ 代码仓库结构: src/
  ✅ 技术栈信息: bcrypt
  ✅ 文件路径: register.js
  ✅ 依赖关系: bcrypt
────────────────────────────────────────────────────────────────────────────────

📈 上下文补充覆盖率: 4/4 类别
```

---

## 🎮 命令说明

### **基本命令**

| 命令 | 说明 | 示例 |
|-----|------|------|
| 直接输入 | 输入提示词进行增强 | `修复bug` |
| `quit` / `exit` / `q` | 退出程序 | `quit` |
| `help` | 显示帮助信息 | `help` |
| `history` | 查看输入历史 | `history` |
| `clear` | 清空输入历史 | `clear` |

### **示例提示词**

```
• 修复bug
• 添加用户注册功能
• 重构代码
• 优化数据库查询
• 实现 API 端点
• 添加错误处理
• 优化性能
• 编写文档
```

---

## 📊 输出说明

### **思考过程（可选）**

```
💭 【模型思考过程】
────────────────────────────────────────────────────────────────────────────────
[DeepSeek 模型的推理过程...]
────────────────────────────────────────────────────────────────────────────────
```

### **原始提示词**

```
📝 【原始提示词】
[您输入的原始提示词]
```

### **增强后提示词**

```
✨ 【增强后提示词】
────────────────────────────────────────────────────────────────────────────────
[增强后的结构化提示词]
────────────────────────────────────────────────────────────────────────────────
```

### **统计信息**

```
📊 【统计信息】
  • 原始长度: X 字符
  • 增强后长度: Y 字符
  • 扩展比例: Z x
  • 处理时间: T 秒
```

### **上下文补充验证**

```
🔍 【上下文补充验证】
────────────────────────────────────────────────────────────────────────────────
  ✅ 代码仓库结构: src/, components/
  ✅ 技术栈信息: React, bcrypt
  ✅ 文件路径: RegisterForm, /api/register
  ✅ 依赖关系: bcrypt 库
────────────────────────────────────────────────────────────────────────────────

📈 上下文补充覆盖率: 4/4 类别
```

---

## ⚙️ 配置选项

### **显示思考过程**

启动时选择是否显示模型的思考过程：
- `y` 或 Enter: 显示完整思考过程（推荐用于学习）
- `n`: 只显示增强结果（推荐用于快速测试）

---

## 💡 使用建议

### **最佳实践**

1. **逐步测试** - 从简短提示词开始，逐步测试更复杂的提示词
2. **对比分析** - 使用 `history` 命令查看历史记录，对比不同提示词的增强效果
3. **验证上下文** - 关注上下文补充验证结果，了解增强效果
4. **记录结果** - 对于重要的测试结果，可以手动记录或截图

### **测试场景**

| 场景 | 推荐提示词 | 预期结果 |
|-----|----------|---------|
| 指令扩展 | "修复bug" | 3-5 个步骤，扩展比例 10x 左右 |
| 上下文补充 | "添加用户注册功能" | 包含 src/, bcrypt 等上下文 |
| 最佳实践 | "重构代码" | 包含代码结构、测试等最佳实践 |
| 长提示词 | "优化数据库查询性能，减少 N+1 问题，添加缓存机制" | 扩展比例 2-3x |

---

## 🔧 故障排除

### **问题 1: API 密钥错误**

```
❌ 错误: DEEPSEEK_API_KEY not found
```

**解决方案**:
1. 确保 `.env` 文件存在
2. 检查 `.env` 文件中是否有 `DEEPSEEK_API_KEY=your_key`
3. 重启脚本

### **问题 2: 处理时间过长**

**说明**: DeepSeek 推理模式需要 30-40 秒，这是正常的

**优化方案**:
- 如果不需要思考过程，启动时选择 `n`
- 使用更简短的提示词

### **问题 3: 网络连接错误**

```
❌ 错误: Connection error
```

**解决方案**:
1. 检查网络连接
2. 确保能访问 DeepSeek API
3. 检查 API 密钥是否有效

---

## 📝 输入历史管理

### **查看历史**

```
> history

【输入历史】
  1. 修复bug
  2. 添加用户注册功能
  3. 重构代码
```

### **清空历史**

```
> clear

✓ 输入历史已清空
```

---

## 📊 性能指标

| 指标 | 值 | 说明 |
|-----|-----|------|
| 平均处理时间 | 30-40 秒 | DeepSeek 推理模式 |
| 平均扩展比例 | 18.53x | 目标 < 20x |
| 最低扩展比例 | 10.20x | 短提示词 |
| 最高扩展比例 | 31.75x | 长提示词 |

---

## 🎯 验证目标

| 目标 | 状态 | 说明 |
|-----|------|------|
| 交互式输入 | ✅ | 支持自定义提示词 |
| 多次连续测试 | ✅ | 无需重启脚本 |
| 思考过程展示 | ✅ | 可选显示 |
| 上下文补充验证 | ✅ | 4 个维度验证 |
| 统计信息 | ✅ | 完整的性能指标 |
| 输入历史记录 | ✅ | 支持查看和清空 |

---

**脚本版本**: v1.0  
**最后更新**: 2025-12-09  
**作者**: Augment Agent

